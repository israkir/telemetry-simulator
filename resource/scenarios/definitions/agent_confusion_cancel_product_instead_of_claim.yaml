# Agent confusion: user intent is cancel_claim but agent calls cancel_product (similar names).
# Same input cluster ("cancel my claim" / "cancel it") maps to both cancel_claim and cancel_product;
# agent picks wrong tool. Trace shows cancel_product tool call (succeeds) and response_compose
# marked fail (goal: ungrounded_response) so wrong-tool traffic is visible in error metrics.

name: agent_confusion_cancel_product_instead_of_claim
description: >
  Tool confusion (cancel_product vs cancel_claim): User wants to cancel a claim. Ambiguous
  phrasing matches both tools; agent incorrectly invokes cancel_product. Trace shows
  cancel_product tool call (succeeds) and response_compose fail with WrongToolError so
  wrong-tool traffic is visible in error metrics. Cause: same input cluster â†’ similar
  tools (cancel_claim vs cancel_product).

tags:
  - data-plane
  - tool-confusion
  - agent-confusion
  - cancel-product
  - cancel-claim

workload_weight: 0.5

mcp_server: electronics
repeat_count: 2
interval_ms: 100
emit_metrics: false
emit_logs: false
redaction_applied: none

data_plane:
  workflow: cancel_product
  goal: ungrounded_response
  latency_profile: happy_path
  control_plane_template: allowed

# response_compose is marked fail so wrong-tool traffic appears in error metrics.
scenario_overrides:
  exception_type: "WrongToolError"
  exception_message: "Agent invoked cancel_product instead of cancel_claim; response not valid for user intent."

# Emitted trace shows cancel_product (what agent called); correct intent was cancel_claim.
expected:
  mcp_server: electronics
  tools:
    - cancel_product

# User wording suggests cancel_claim; agent responds as if cancel_product was executed.
conversation:
  samples:
    - user_input: "I want to cancel my claim."
      llm_response: "I've cancelled the product. Your cover will end at the next billing date."
    - user_input: "Cancel the claim please."
      llm_response: "Done. The product has been cancelled. No further charges."
    - user_input: "Can you cancel it? I don't need the repair anymore."
      llm_response: "Cancelled. Your policy for this product will not renew."
    - user_input: "Stop my claim."
      llm_response: "I've cancelled the product. You'll get a confirmation email."

context:
  tenant: toro
  agent: toro-customer-assistant-001
  mcp_server: electronics
  tool_call_arguments:
    cancel_product: { policy_id: "pol_xyz789", reason: "replacement" }
